# This cfg file is for fitting vecps omega pi0 data directly with moments

# Usage is similar to vector pseudoscalar amplitude analysis fits but the "amplitude"
# here is one that contains all the moments we want to fit with. 
# See AMPTOOLS_AMPS/Vec_ps_moment.cc for details and usage.

###### SETUP ######
fit omegapi

# setup the parRange ability
keyword parRange 3 3

######## DATA REACTIONS AND SUMS ########
reaction omegapi Beam Proton Pi01 Pi02 Pi+ Pi-
genmc omegapi ROOTDataReader anglesOmegaPiPhaseSpace.root
accmc omegapi ROOTDataReader anglesOmegaPiPhaseSpaceAcc.root
data omegapi ROOTDataReader anglesOmegaPiAmplitude_0.root

normintfile omegapi omegapi.nm

sum omegapi vecPSMoment

######## "FULL" SET OF MOMENTS ########
# These are all possible moments (including zero ones) for S,P,D waveset
# we have applied filters to remove -Lambda and -M moments though, and no Jv=1 
# parameter H0_0000 16000.0 bounded 0.0 20000.0
# parameter H2_2211 0.0 bounded -16000 16000
# parameter H1_0100 0.0 bounded -16000 16000
# parameter H0_2110 0.0 bounded -16000 16000
# parameter H1_0111 0.0 bounded -16000 16000
# parameter H2_2110 0.0 bounded -16000 16000
# parameter H2_2001 0.0 bounded -16000 16000
# parameter H0_0201 0.0 bounded -16000 16000
# parameter H0_2000 0.0 bounded -16000 16000
# parameter H1_0121 0.0 bounded -16000 16000
# parameter H0_2021 0.0 bounded -16000 16000
# parameter H0_0100 0.0 bounded -16000 16000
# parameter H2_0020 0.0 bounded -16000 16000
# parameter H1_0001 0.0 bounded -16000 16000
# parameter H2_0210 0.0 bounded -16000 16000
# parameter H2_0211 0.0 bounded -16000 16000
# parameter H1_2210 0.0 bounded -16000 16000
# parameter H0_0011 0.0 bounded -16000 16000
# parameter H0_0111 0.0 bounded -16000 16000
# parameter H0_0221 0.0 bounded -16000 16000
# parameter H1_2101 0.0 bounded -16000 16000
# parameter H0_2210 0.0 bounded -16000 16000
# parameter H1_2201 0.0 bounded -16000 16000
# parameter H1_2120 0.0 bounded -16000 16000
# parameter H1_0210 0.0 bounded -16000 16000
# parameter H1_2100 0.0 bounded -16000 16000
# parameter H1_2021 0.0 bounded -16000 16000
# parameter H0_0021 0.0 bounded -16000 16000
# parameter H2_2200 0.0 bounded -16000 16000
# parameter H2_0220 0.0 bounded -16000 16000
# parameter H2_2111 0.0 bounded -16000 16000
# parameter H1_0000 0.0 bounded -16000 16000
# parameter H1_2020 0.0 bounded -16000 16000
# parameter H2_0011 0.0 bounded -16000 16000
# parameter H0_0220 0.0 bounded -16000 16000
# parameter H0_0120 0.0 bounded -16000 16000
# parameter H0_2020 0.0 bounded -16000 16000
# parameter H2_0201 0.0 bounded -16000 16000
# parameter H2_2010 0.0 bounded -16000 16000
# parameter H0_0200 0.0 bounded -16000 16000
# parameter H2_2021 0.0 bounded -16000 16000
# parameter H2_0110 0.0 bounded -16000 16000
# parameter H0_0010 0.0 bounded -16000 16000
# parameter H2_2220 0.0 bounded -16000 16000
# parameter H0_2220 0.0 bounded -16000 16000
# parameter H1_2220 0.0 bounded -16000 16000
# parameter H2_2101 0.0 bounded -16000 16000
# parameter H1_0011 0.0 bounded -16000 16000
# parameter H2_0100 0.0 bounded -16000 16000
# parameter H0_2010 0.0 bounded -16000 16000
# parameter H2_0000 0.0 bounded -16000 16000
# parameter H2_2221 0.0 bounded -16000 16000
# parameter H1_2010 0.0 bounded -16000 16000
# parameter H1_0120 0.0 bounded -16000 16000
# parameter H0_0211 0.0 bounded -16000 16000
# parameter H1_2111 0.0 bounded -16000 16000
# parameter H1_0211 0.0 bounded -16000 16000
# parameter H1_0110 0.0 bounded -16000 16000
# parameter H2_0021 0.0 bounded -16000 16000
# parameter H0_0121 0.0 bounded -16000 16000
# parameter H0_2201 0.0 bounded -16000 16000
# parameter H1_2211 0.0 bounded -16000 16000
# parameter H1_0201 0.0 bounded -16000 16000
# parameter H2_0010 0.0 bounded -16000 16000
# parameter H2_0001 0.0 bounded -16000 16000
# parameter H2_2201 0.0 bounded -16000 16000
# parameter H2_0200 0.0 bounded -16000 16000
# parameter H1_2121 0.0 bounded -16000 16000
# parameter H1_2000 0.0 bounded -16000 16000
# parameter H1_2110 0.0 bounded -16000 16000
# parameter H1_0020 0.0 bounded -16000 16000
# parameter H2_0221 0.0 bounded -16000 16000
# parameter H0_0101 0.0 bounded -16000 16000
# parameter H0_2011 0.0 bounded -16000 16000
# parameter H2_2020 0.0 bounded -16000 16000
# parameter H0_2200 0.0 bounded -16000 16000
# parameter H0_0110 0.0 bounded -16000 16000
# parameter H0_2221 0.0 bounded -16000 16000
# parameter H1_0010 0.0 bounded -16000 16000
# parameter H2_2121 0.0 bounded -16000 16000
# parameter H0_0020 0.0 bounded -16000 16000
# parameter H1_0101 0.0 bounded -16000 16000
# parameter H0_2211 0.0 bounded -16000 16000
# parameter H0_2001 0.0 bounded -16000 16000
# parameter H2_0120 0.0 bounded -16000 16000
# parameter H2_0111 0.0 bounded -16000 16000
# parameter H2_2100 0.0 bounded -16000 16000
# parameter H1_2011 0.0 bounded -16000 16000
# parameter H1_0021 0.0 bounded -16000 16000
# parameter H0_2101 0.0 bounded -16000 16000
# parameter H2_2120 0.0 bounded -16000 16000
# parameter H0_2111 0.0 bounded -16000 16000
# parameter H0_2121 0.0 bounded -16000 16000
# parameter H2_0121 0.0 bounded -16000 16000
# parameter H1_2200 0.0 bounded -16000 16000
# parameter H1_2221 0.0 bounded -16000 16000
# parameter H2_2000 0.0 bounded -16000 16000
# parameter H2_2210 0.0 bounded -16000 16000
# parameter H1_2001 0.0 bounded -16000 16000
# parameter H2_0101 0.0 bounded -16000 16000
# parameter H1_0221 0.0 bounded -16000 16000
# parameter H1_0220 0.0 bounded -16000 16000
# parameter H0_2100 0.0 bounded -16000 16000
# parameter H1_0200 0.0 bounded -16000 16000
# parameter H0_0001 0.0 bounded -16000 16000
# parameter H0_0210 0.0 bounded -16000 16000
# parameter H0_2120 0.0 bounded -16000 16000
# parameter H2_2011 0.0 bounded -16000 16000

######## FILTERED SET OF MOMENTS ########
# applied more filters:
#   - removed Lambda > Jv, Lambda > J, M > J
#   - removed (Jv==2 AND Lambda==0) moments
#   - removed (alpha==2 AND Lambda==2 AND M==0) moments
# parameter H0_0000 16000.0 bounded 0.0 20000.0
# parameter H0_2110 0.0 bounded -16000 16000
# parameter H2_2110 0.0 bounded -16000 16000
# parameter H0_0011 0.0 bounded -16000 16000
# parameter H1_2120 0.0 bounded -16000 16000
# parameter H0_0021 0.0 bounded -16000 16000
# parameter H2_2111 0.0 bounded -16000 16000
# parameter H1_0000 0.0 bounded -16000 16000
# parameter H2_0011 0.0 bounded -16000 16000
# parameter H0_0010 0.0 bounded -16000 16000
# parameter H2_2220 0.0 bounded -16000 16000
# parameter H0_2220 0.0 bounded -16000 16000
# parameter H1_2220 0.0 bounded -16000 16000
# parameter H1_0011 0.0 bounded -16000 16000
# parameter H2_2221 0.0 bounded -16000 16000
# parameter H1_2111 0.0 bounded -16000 16000
# parameter H2_0021 0.0 bounded -16000 16000
# parameter H1_2121 0.0 bounded -16000 16000
# parameter H1_2110 0.0 bounded -16000 16000
# parameter H1_0020 0.0 bounded -16000 16000
# parameter H0_2221 0.0 bounded -16000 16000
# parameter H1_0010 0.0 bounded -16000 16000
# parameter H2_2121 0.0 bounded -16000 16000
# parameter H0_0020 0.0 bounded -16000 16000
# parameter H1_0021 0.0 bounded -16000 16000
# parameter H2_2120 0.0 bounded -16000 16000
# parameter H0_2111 0.0 bounded -16000 16000
# parameter H0_2121 0.0 bounded -16000 16000
# parameter H1_2221 0.0 bounded -16000 16000
# parameter H0_2120 0.0 bounded -16000 16000

# same, but without bounds
parameter H0_0000 16000.0
parameter H0_2110 0.0
parameter H2_2110 0.0
parameter H0_0011 0.0
parameter H1_2120 0.0
parameter H0_0021 0.0
parameter H2_2111 0.0
parameter H1_0000 0.0
parameter H2_0011 0.0
parameter H0_0010 0.0
parameter H2_2220 0.0
parameter H0_2220 0.0
parameter H1_2220 0.0
parameter H1_0011 0.0
parameter H2_2221 0.0
parameter H1_2111 0.0
parameter H2_0021 0.0
parameter H1_2121 0.0
parameter H1_2110 0.0
parameter H1_0020 0.0
parameter H0_2221 0.0
parameter H1_0010 0.0
parameter H2_2121 0.0
parameter H0_0020 0.0
parameter H1_0021 0.0
parameter H2_2120 0.0
parameter H0_2111 0.0
parameter H0_2121 0.0
parameter H1_2221 0.0
parameter H0_2120 0.0

# these are not bounds but rather a range of values the moments are allowed to be
# randomly initialized to. I've chosen the range to be -N/2 to N/2 where N is the number 
# of events in the MC dataset.
parRange H0_2110 -8000 8000
parRange H2_2110 -8000 8000
parRange H0_0011 -8000 8000
parRange H1_2120 -8000 8000
parRange H0_0021 -8000 8000
parRange H2_2111 -8000 8000
parRange H1_0000 -8000 8000
parRange H2_0011 -8000 8000
parRange H0_0010 -8000 8000
parRange H2_2220 -8000 8000
parRange H0_2220 -8000 8000
parRange H1_2220 -8000 8000
parRange H1_0011 -8000 8000
parRange H2_2221 -8000 8000
parRange H1_2111 -8000 8000
parRange H2_0021 -8000 8000
parRange H1_2121 -8000 8000
parRange H1_2110 -8000 8000
parRange H1_0020 -8000 8000
parRange H0_2221 -8000 8000
parRange H1_0010 -8000 8000
parRange H2_2121 -8000 8000
parRange H0_0020 -8000 8000
parRange H1_0021 -8000 8000
parRange H2_2120 -8000 8000
parRange H0_2111 -8000 8000
parRange H0_2121 -8000 8000
parRange H1_2221 -8000 8000
parRange H0_2120 -8000 8000

# this is the amplitude we are fitting with which contains all the moments
# Note that we are passing a fixed polarization angle of 0 and fraction of 0.35

# below is the full set of moments
# amplitude omegapi::vecPSMoment::vecPSMoment Vec_ps_moment 0 0.35 [H0_0000] [H2_2211] [H1_0100] [H0_2110] [H1_0111] [H2_2110] [H2_2001] [H0_0201] [H0_2000] [H1_0121] [H0_2021] [H0_0100] [H2_0020] [H1_0001] [H2_0210] [H2_0211] [H1_2210] [H0_0011] [H0_0111] [H0_0221] [H1_2101] [H0_2210] [H1_2201] [H1_2120] [H1_0210] [H1_2100] [H1_2021] [H0_0021] [H2_2200] [H2_0220] [H2_2111] [H1_0000] [H1_2020] [H2_0011] [H0_0220] [H0_0120] [H0_2020] [H2_0201] [H2_2010] [H0_0200] [H2_2021] [H2_0110] [H0_0010] [H2_2220] [H0_2220] [H1_2220] [H2_2101] [H1_0011] [H2_0100] [H0_2010] [H2_2221] [H1_2010] [H1_0120] [H0_0211] [H1_2111] [H1_0211] [H1_0110] [H2_0021] [H0_0121] [H0_2201] [H1_2211] [H1_0201] [H2_0010] [H2_0001] [H2_2201] [H2_0200] [H1_2121] [H1_2000] [H1_2110] [H1_0020] [H2_0221] [H0_0101] [H0_2011] [H2_2020] [H0_2200] [H0_0110] [H0_2221] [H1_0010] [H2_2121] [H0_0020] [H1_0101] [H0_2211] [H0_2001] [H2_0120] [H2_0111] [H2_2100] [H1_2011] [H1_0021] [H0_2101] [H2_2120] [H0_2111] [H0_2121] [H2_0121] [H1_2200] [H1_2221] [H2_2000] [H2_2210] [H1_2001] [H2_0101] [H1_0221] [H1_0220] [H0_2100] [H1_0200] [H0_0001] [H0_0210] [H0_2120] [H2_2011]
# below is the filtered set of moments
amplitude omegapi::vecPSMoment::vecPSMoment Vec_ps_moment 0 0.35 [H0_0000] [H0_2110] [H2_2110] [H0_0011] [H1_2120] [H0_0021] [H2_2111] [H1_0000] [H2_0011] [H0_0010] [H2_2220] [H0_2220] [H1_2220] [H1_0011] [H2_2221] [H1_2111] [H2_0021] [H1_2121] [H1_2110] [H1_0020] [H0_2221] [H1_0010] [H2_2121] [H0_0020] [H1_0021] [H2_2120] [H0_2111] [H0_2121] [H1_2221] [H0_2120]
initialize omegapi::vecPSMoment::vecPSMoment cartesian 1 0 fixed
